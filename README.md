# FEM Lattice Simulation: Biaxial and Shear Tests

This project performs finite element analysis (FEM) on a 3D lattice structure using Gmsh-generated tetrahedral meshes in ASCII v2 `.msh` format. It supports both **biaxial** and **shear** mechanical tests with appropriate boundary conditions, and computes the total **reaction force** on fixed surfaces.


- 3D geometry of size `100 x 100 x 100` mmÂ³.
- Mesh generated by [Gmsh](https://gmsh.info/) in ASCII v2 `.msh` format (tetrahedral elements).
- Mesh is parsed and scaled appropriately before FEM analysis.


### ðŸ”¹ Biaxial Test
- Applies compressive or tensile displacements.
- Implements **Dirichlet boundary conditions** on the corresponding faces.

### ðŸ”¹ Shear Test
- Applies shear strain using the **masterâ€“slave method**.
- Constrains slave nodes to follow the master plane motion.


- Linear elasticity analysis with custom FEM implementation.
- Stiffness matrix assembled from tetrahedral elements.
- Displacement boundary conditions applied explicitly.
- Reaction forces computed on the constrained faces (e.g., `y = 0` plane).


- Outputs total **reaction force** on fixed boundary surfaces.
- Supports both biaxial and shear loading modes.
- Designed for further post-processing (stress-strain plots, etc.).


This project requires:

- Python 3.10+
- [Conda](https://docs.conda.io/) (recommended)
- The following Python packages:
  ```bash
  numpy
  scipy
  numba
  pypardiso      # Optional, for faster linear solvers
  vedo           # Optional, for 3D visualization
  ```

Install all at once with conda:
```bash
conda create -n fem_env python=3.10 -y
conda activate fem_env
conda install numpy scipy numba -y
conda install -c conda-forge pypardiso vedo
```


#### ðŸ”¹ Run a Biaxial Test (compression or tension):
```bash
python biaxial_test.py
```

This test:
- Applies vertical compression (displacement -0.2 mm at y=100 mm)
- Fully fixes y=0 mm face in y-direction
- Fixes selective x/z displacements to prevent rigid motion
- Computes total reaction force on y=0 mm face in y-direction

#### ðŸ”¹ Run a Shear Test (Masterâ€“Slave Matching):
```bash
python shear_test.py
```

This test:
- Applies shear in z-direction at y=100 mm
- Fully fixes all displacements on y=0 mm face
- Applies periodic matching for x=0/100 mm and z=0/100 mm faces (ux/uy only)
- Computes total reaction force in z-direction at y=0 mm

Ensure your `.msh` files are placed in the `examples/` folder or update the path accordingly in the script.


```
fem-lattice-solver/
â”œâ”€â”€ biaxial_test.py
â”œâ”€â”€ shear_test.py
â”œâ”€â”€ femcore/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ io.py
â”‚   â”œâ”€â”€ assembly.py
â”‚   â””â”€â”€ utils.py
â”œâ”€â”€ examples/            # Place .msh mesh files here
â””â”€â”€ README.md
```